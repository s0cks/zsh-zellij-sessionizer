# https://lefthook.dev/configuration/index.html
commit-msg:
  commands:
    "lint commit message":
      run: cog verify --file {1}
pre-commit:
  commands:
    "mark scripts as executable":
      files: git diff --name-only --diff-filter=d --staged
      run: |
        #!/usr/bin/env zsh
        for file in "{staged_files}"; do
          shebangs=$(head -n 1 "$file")
          if [[ "$shebangs" == "#!/"* ]]; then
            if [[ ! -x "$file" ]]; then
              echo "marking $file executable"
              chmod +x "$file"
              git add "$file"
            fi
          fi
        done
    "detect secrets":
      files: git diff --name-only --diff-filter=d --staged
      run: gitleaks protect --no-banner --staged --redact --verbose 
